@using Panoptic.Areas.Ops.Models
@model Panoptic.Areas.Ops.Models.MachineStatusModel

@{
    ViewBag.Title = Model.Name;
}

@functions {
    internal string StatusToText(ServiceStatus status)
    {
        switch (status)
        {
            case ServiceStatus.Ok:
                return "Ok";
            case ServiceStatus.Warning:
                return "Warning";
            case ServiceStatus.Error:
                return "Error";
            default:
                return "alert-info";
        }
    }

    internal string StatusToCssAlertClass(ServiceStatus status)
    {
        switch (status)
        {
            case ServiceStatus.Ok:
                return "alert-success";
            case ServiceStatus.Warning:
                return "alert-warning";
            case ServiceStatus.Error:
                return "alert-danger";
            default:
                return "Unknown";
        }
    }
}

<div class="jumbotron">
    <h1>@Html.DisplayFor(model => model.Name)</h1>
    <p class="lead">@Html.DisplayFor(model => model.Description)</p>
</div>
<div>
    <div>
        <h2>Current status</h2>
        <p>
            The current status of the machines.
        </p>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Status</th>
                    <th colspan="2">CPU</th>
                    <th colspan="3">Memory</th>
                    <th>Disks</th>
                    <th>Issues</th>
                </tr>
                <tr>
                    <th></th>
                    <th></th>
                    <th>Current</th>
                    <th>History</th>
                    <th>In use</th>
                    <th>Total</th>
                    <th>&#37; in use</th>
                    <th></th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>@Html.DisplayFor(model => Model.Name)</td>
                    <td class="alert @StatusToCssAlertClass(Model.Status)">@StatusToText(Model.Status)</td>
                    <td>@Html.DisplayFor(model => Model.CpuPercentage) &#37;</td>
                    <td>CPU history ...</td>
                    <td>@Html.DisplayFor(model => Model.MemoryInUseInGb) Gb</td>
                    <td>@Html.DisplayFor(model => Model.MemoryTotalInGb) Gb</td>
                    <td>@Html.DisplayFor(model => Model.MemoryInUsePercentage) &#37;</td>
                    <td>disks ....</td>
                    <td>@Html.DisplayFor(model => Model.Notification)</td>
                </tr>
            </tbody>
        </table>

        <h2>Logs</h2>
        <p>
            The latest logs coming from the machine.
        </p>

        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Type</th>
                    <th>Log</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var log in Model.Logs)
                {
                    <tr>
                        <td>@Html.DisplayFor(model => log.Date)</td>
                        <td>@Html.DisplayFor(model => log.Type)</td>
                        <td>@Html.DisplayFor(model => log.Text)</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>
